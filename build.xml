<!-- ======================================================================= -->
<!-- TOP level build file                                                -->
<!-- ======================================================================= -->
<project name="jldap" default="debug" basedir=".">
<!-- Targets                                                                 -->
<!--     clean   - Cleans all generated files and directories in this and    -->
<!--               subbordinate directories                                  -->
<!--     cleanpkg- Cleans pkg directory                                      -->
<!--     doc     - Builds javadoc files                                      -->
<!--               Not available at the lowest directory level               -->
<!--     debug   - Builds debug classes and jar files                        -->
<!--               At the lowest level directory it only compiles java files.-->
<!--     release - Builds release classes and jar files                      -->
<!--               At the lowest level directory it only compiles java files.-->
<!--     lib     - Builds debug & release classes and jar files.             -->
<!--               At the lowest level directory it only compiles java files.-->
<!--     jar     - Synonym for lib                                           -->
<!--     all     - Builds everything possible.  At the top directory level it-->
<!--               builds all, doc, & install.  At one directory level below --> 
<!--               the top it builds all, & doc. At the lowest directory     -->
<!--               level it compiles java files for release and debug.       -->
<!--     install - Copies build results from all directories and creates the -->
<!--               pkg directory.  Only available in top makefile            -->
<!--     pkg     - Synonym for install                                       -->

<property name="pkg" value="pkg"/>
<property name="pkg.lib" value="pkg/lib"/>
<property name="pkg.lib.debug" value="pkg/lib_debug"/>
<property name="pkg.doc" value="pkg/doc"/>
<property name="pkg.doc.framewk" value="pkg/doc/framewk"/>
<property name="pkg.doc.ldap" value="pkg/doc/ldap"/>
<property name="pkg.samples" value="pkg/samples"/>

<property name="lib" value="lib"/>
<property name="doc" value="doc"/>
<property name="doc.ldap" value="doc/ldap"/>
<property name="lib.debug" value="lib_debug"/>
<property name="src" value="src"/>

  <target name="init">
    <tstamp/>
  </target>

  <target name="clean" depends="cleanpkg">
    <ant dir="${basedir}/${src}" target="clean"/>
  </target>

  <target name="cleanpkg" depends="init">
	<deltree dir="${pkg}"/>
  </target>

  <target name="doc" depends="ldap.debug">
    <ant dir="${basedir}/${src}" target="doc"/>
  </target>

  <target name="debug" depends="ldap.debug"/>

  <target name="ldap.debug" depends="init">
    <ant dir="${basedir}/${src}" target="debug" />
  </target>

  <target name="release" depends="init">
    <ant dir="${basedir}/${src}" target="release" />
  </target>

  <target name="final" depends="release" />

  <target name="lib" depends="debug, release"/>

  <target name="jar" depends="lib"/>

  <target name="install" depends="init">
	<mkdir dir="${src}/${doc.framewk}"/>
	<mkdir dir="${src}/${doc.ldap}"/>
	<mkdir dir="${src}/${lib}"/>
	<mkdir dir="${src}/${lib.debug}"/>
	<mkdir dir="${novbp}/${doc}"/>
	<mkdir dir="${novbp}/${lib}"/>
	<mkdir dir="${novbp}/${lib.debug}"/>
	<mkdir dir="${pkg.lib}"/>
	<mkdir dir="${pkg.lib.debug}"/>
	<mkdir dir="${pkg.doc}"/>
	<mkdir dir="${pkg.doc}/${ldap}"/>
	<mkdir dir="${pkg.samples}"/>
	<mkdir dir="${pkg.samples}/extensions"/>

	<copydir src="${src}/${lib}"         dest="${pkg.lib}"/>

	<copydir src="${src}/${lib.debug}"   dest="${pkg.lib.debug}"/>

	<copydir src="${src}/${doc.framewk}" dest="${pkg.doc.framewk}"/>
	<copydir src="${src}/${doc.ldap}"    dest="${pkg.doc.ldap}"/>

	<copydir src="${src}/samples/extensions"  dest="${pkg.samples}/extensions"/>
  </target>

  <target name="pkg" depends="install"/>

  <target name="all.subdir" depends="init">
    <ant dir="${basedir}/${src}" target="all" />
  </target>

  <target name="all" depends="init, all.subdir, cleanpkg, install" />

  <target name="samples" depends="init">
    <ant dir="${basedir}/${src}" target="samples" />
  </target>

  <!-- ===================================================================== -->
  <!-- build test classes                                                    -->
  <!-- ===================================================================== -->
  <target name="tests" depends="debug">
          <mkdir dir="${build.tests}/extensions"/>

      <echo message="DEBUG compile tests" />
              <ant dir="tests" target="all">
                      <property name="build" value="${build.samples}"/>
                      <property name="lib" value="${lib.debug}"/>
                      <property name="ldap" value="${ldap}"/>
                      <property name="debug" value="on"/>
                      <property name="optimize" value="off"/>
              </ant>
     </target>

</project>
